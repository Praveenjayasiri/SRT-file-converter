import re
import sys

def is_time_stamp(l):
    if l[:2].isnumeric() and l[2] == ':':
        return True
    return False

def has_letters(line):
    if re.search('[a-zA-Z]', line):
        return True
    return False

def has_no_text(line):
    l = line.strip()
    if not len(l):
        return True
    if l.isnumeric():
        return True
    if is_time_stamp(l):
        return True
    if l[0] == '(' and l[-1] == ')':
        return True
    if not has_letters(line):
        return True
    return False

def is_lowercase_letter_or_comma(letter):
    if letter.isalpha() and letter.lower() == letter:
        return True
    if letter == ',':
        return True
    return False

def clean_up(lines):
    new_lines = []
    for line in lines[1:]:
        if has_no_text(line):
            continue
        elif len(new_lines) and is_lowercase_letter_or_comma(line[0]):
            # combine with previous line
            new_lines[-1] = new_lines[-1].strip() + ' ' + line
        else:
            # append line
            new_lines.append(line)
    return new_lines

def main(args):
    file_name = 'FriendsS01E01.srt'
    with open(file_name) as f:
        lines = f.readlines()
        new_lines = clean_up(lines)
    new_file_name = file_name[:-4] + '.txt'
    with open(new_file_name, 'w') as f:
        for i, line in enumerate(new_lines, start=1):
            f.write(f"{i}. {line.strip()}\n")
           
if __name__ == '__main__':
    main(sys.argv)